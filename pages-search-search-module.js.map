{"version":3,"sources":["./src/app/pages/search/search-routing.module.ts","./src/app/pages/search/component/search.component.ts","./src/app/pages/search/component/search.component.html","./src/app/services/image.service.ts","./src/app/model/image.model.ts","./src/app/pages/search/search.module.ts"],"names":[],"mappings":"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","file":"pages-search-search-module.js","sourcesContent":["import { NgModule } from \"@angular/core\";\r\nimport { Routes, RouterModule } from \"@angular/router\";\r\n\r\nimport { SearchComponent } from \"@app/pages/search/component/search.component\";\r\n\r\nconst routes: Routes = [\r\n\t{\r\n\t  path: '',\r\n\t  component: SearchComponent,\r\n\t  data: {\r\n\t\ttitle: 'Search',\r\n\t  },\r\n\t},\r\n  ];\r\n@NgModule({\r\n\timports: [RouterModule.forChild(routes)],\r\n\texports: [RouterModule],\r\n\tproviders: [],\r\n})\r\nexport class SearchRoutingModule {}\r\n","import { ChangeDetectionStrategy, ChangeDetectorRef, Component, ElementRef, OnInit, ViewChild } from \"@angular/core\";\r\nimport { debounceTime, finalize } from \"rxjs/operators\";\r\nimport { IPageInfo, VirtualScrollerComponent } from \"ngx-virtual-scroller\";\r\nimport { environment } from \"@env/environment\";\r\nimport { ActivatedRoute } from \"@angular/router\";\r\nimport { SearchImages, ImageDetail } from \"@app/model/image.model\";\r\nimport { ImageService } from \"@app/services/image.service\";\r\nimport { NgbModal } from \"@ng-bootstrap/ng-bootstrap\";\r\nimport { ComingSoonComponent } from \"@app/@shared/component/coming-soon/coming-soon.component\";\r\n\r\n@Component({\r\n\tselector: \"app-search\",\r\n\ttemplateUrl: \"./search.component.html\",\r\n\tstyleUrls: [\"./search.component.scss\"],\r\n\tchangeDetection: ChangeDetectionStrategy.OnPush,\r\n})\r\nexport class SearchComponent implements OnInit {\r\n\tprivate keywords: string = \"\";\r\n\tprivate startIndex: number = 1;\r\n\tpublic totalItems: number = 0;\r\n\tpublic isLoading = false;\r\n\r\n\t@ViewChild(\"imageContent\") imageContent: ElementRef;\r\n\t@ViewChild(VirtualScrollerComponent) imageScroller: VirtualScrollerComponent;\r\n\r\n\tprivate maxPage: number = environment.max_page;\r\n\tprivate fullSearchImages: SearchImages = new SearchImages();\r\n\tpublic images: ImageDetail[] = [];\r\n\r\n\tconstructor(\r\n\t\tprivate activatedRoute: ActivatedRoute,\r\n\t\tprivate cdr: ChangeDetectorRef,\r\n\t\tprivate modal: NgbModal,\r\n\t\tprivate imageService: ImageService\r\n\t) {}\r\n\r\n\tngOnInit() {\r\n\t\tthis.activatedRoute.queryParams.subscribe((params) => {\r\n\t\t\tif (params[\"q\"]) {\r\n\t\t\t\tthis.keywords = params[\"q\"];\r\n\t\t\t}\r\n\t\t\tif (params[\"page\"]) {\r\n\t\t\t\tthis.startIndex = Number(params[\"page\"]);\r\n\t\t\t}\r\n\t\t\tif (this.keywords) {\r\n\t\t\t\tthis.fullSearchImages = new SearchImages();\r\n\t\t\t\tthis.search(this.keywords, this.startIndex);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tprivate search(keywords: string, startIndex: number): void {\r\n\t\tthis.isLoading = true;\r\n\t\tthis.imageService\r\n\t\t\t.search(keywords, startIndex)\r\n\t\t\t.pipe(\r\n\t\t\t\tdebounceTime(300),\r\n\t\t\t\tfinalize(() => {\r\n\t\t\t\t\tthis.isLoading = false;\r\n\t\t\t\t\tthis.cdr.detectChanges();\r\n\t\t\t\t})\r\n\t\t\t)\r\n\t\t\t.subscribe((data: SearchImages) => {\r\n\t\t\t\tthis.totalItems = data.total;\r\n\t\t\t\tif (data && data.hits) {\r\n\t\t\t\t\tthis.fullSearchImages.hits = [...this.fullSearchImages.hits, ...data.hits];\r\n\t\t\t\t\tthis.images = [...this.fullSearchImages.hits];\r\n\t\t\t\t\tthis.imageScroller?.refresh();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t}\r\n\r\n\tonVsEnd(event: IPageInfo) {\r\n\t\tthis.imageContent.nativeElement.style.height = event.maxScrollPosition + window.innerHeight + 120 + \"px\";\r\n\t\tthis.fetchMore(event);\r\n\t}\r\n\r\n\tprivate fetchMore(event: IPageInfo): void {\r\n\t\tif (event.endIndex === -1) return;\r\n\t\t// Just support load first 5 pages for easy review\r\n\t\tif (this.startIndex === this.maxPage) return;\r\n\t\tif (event.endIndex !== this.images.length - 1) return;\r\n\t\tif (this.startIndex >= this.totalItems) return;\r\n\t\tif (this.fullSearchImages.hits) {\r\n\t\t\tthis.startIndex += 1;\r\n\t\t}\r\n\t\tthis.search(this.keywords, this.startIndex);\r\n\t}\r\n\r\n\topenDetail() {\r\n\t\tthis.modal.open(ComingSoonComponent, { centered: true }).result.then(\r\n\t\t\t() => {},\r\n\t\t\t() => {}\r\n\t\t);\r\n\t}\r\n}\r\n","<div class=\"search-panel animate__animated animate__fadeIn\">\r\n\t<div class=\"container\" #imageContent>\r\n\t\t<nav class=\"nav-search navbar navbar-expand p-0\">\r\n\t\t\t<div class=\"mr-auto results\">\r\n\t\t\t\t<span *ngIf=\"totalItems\">About {{ totalItems }} results</span>\r\n\t\t\t</div>\r\n\t\t</nav>\r\n\t\t<virtual-scroller\r\n\t\t\tclass=\"row\"\r\n\t\t\t#imageScroller\r\n\t\t\t[items]=\"images\"\r\n\t\t\t[parentScroll]=\"imageScroller.window\"\r\n\t\t\t(vsEnd)=\"onVsEnd($event)\"\r\n\t\t>\r\n\t\t\t<div\r\n\t\t\t\tclass=\"col-sm-6 col-md-4 col-lg-3 animate__animated animate__fadeIn\"\r\n\t\t\t\t*ngFor=\"let item of imageScroller.viewPortItems; let index = index\"\r\n\t\t\t>\r\n\t\t\t\t<div class=\"search-item shadow border mt-4\" (click)=\"openDetail()\">\r\n\t\t\t\t\t<app-image\r\n\t\t\t\t\t\t[image]=\"item.webformatURL\"\r\n\t\t\t\t\t\t[height]=\"300\"\r\n\t\t\t\t\t\t[alt]=\"item.tags\"\r\n\t\t\t\t\t></app-image>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</virtual-scroller>\r\n\t\t<p class=\"pt-4\" *ngIf=\"!isLoading && images && images.length === 0\">Sorry, No data avaiable</p>\r\n\t</div>\r\n\t<app-loader class=\"w-100\" [isLoading]=\"isLoading\"></app-loader>\r\n</div>\r\n","import { Injectable } from \"@angular/core\";\r\nimport { environment } from \"@env/environment\";\r\nimport { ApiService } from \"@app/@core/services/api.service\";\r\nimport { HttpParams } from \"@angular/common/http\";\r\n\r\n@Injectable({\r\n\tprovidedIn: \"root\",\r\n})\r\nexport class ImageService {\r\n\titemPerPage: string = environment.itemPerPage;\r\n\r\n\tconstructor(private apiService: ApiService) {}\r\n\r\n\tsearch(keywords: string, startIndex: number) {\r\n\t\tconst params = new HttpParams()\r\n\t\t\t.set(\"key\", environment.api_key)\r\n\t\t\t.set(\"q\", encodeURIComponent(keywords))\r\n\t\t\t.set(\"image_type\", 'photo')\r\n\t\t\t.set(\"pretty\", 'true')\r\n\t\t\t.set(\"page\", startIndex ? startIndex.toString() : \"1\")\r\n\t\t\t.set(\"per_page\", this.itemPerPage)\r\n\t\t\t.set(\"lang\", localStorage.getItem(\"language\"));\r\n\t\treturn this.apiService.get(\"\", params);\r\n\t}\r\n}\r\n","export class SearchImages {\r\n\ttotalHits: number = null;\r\n\ttotal: number = null;\r\n\thits: ImageDetail[] = [];\r\n}\r\n\r\nexport interface ImageDetail {\r\n\tcomments: number;\r\n\tdownloads: number;\r\n\tfavorites: number;\r\n\tid: number;\r\n\timageHeight: number;\r\n\timageSize: number;\r\n\timageWidth: number;\r\n\tlargeImageURL: string;\r\n\tlikes: number;\r\n\tpageURL: string;\r\n\tpreviewHeight: number;\r\n\tpreviewURL: string;\r\n\tpreviewWidth: number;\r\n\ttags: string;\r\n\ttype: string;\r\n\tuser: string;\r\n\tuserImageURL: string;\r\n\tuser_id: number;\r\n\tviews: number;\r\n\twebformatHeight: number;\r\n\twebformatURL: string;\r\n\twebformatWidth: number;\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { TranslateModule } from '@ngx-translate/core';\r\nimport { VirtualScrollerModule } from 'ngx-virtual-scroller';\r\nimport { LazyLoadImageModule } from 'ng-lazyload-image';\r\n\r\nimport { SharedModule } from '@shared';\r\nimport { SearchRoutingModule } from '@app/pages/search/search-routing.module';\r\nimport { SearchComponent } from '@app/pages/search/component/search.component';\r\nimport { FormsModule } from '@angular/forms';\r\n\r\n@NgModule({\r\n\timports: [\r\n\t\tCommonModule,\r\n\t\tFormsModule,\r\n\t\tTranslateModule,\r\n\t\tVirtualScrollerModule,\r\n\t\tLazyLoadImageModule,\r\n\t\tSharedModule,\r\n\t\tSearchRoutingModule,\r\n\t],\r\n\tdeclarations: [SearchComponent],\r\n\tproviders: [\r\n\t\t{\r\n\t\t\tprovide: 'virtual-scroller-default-options',\r\n\t\t\tuseValue: {\r\n\t\t\t\tcheckResizeInterval: 1000,\r\n\t\t\t\tmodifyOverflowStyleOfParentScroll: true,\r\n\t\t\t\tresizeBypassRefreshThreshold: 5,\r\n\t\t\t\tscrollAnimationTime: 750,\r\n\t\t\t\tscrollDebounceTime: 0,\r\n\t\t\t\tscrollThrottlingTime: 0,\r\n\t\t\t\tstripedTable: false,\r\n\t\t\t},\r\n\t\t},\r\n\t],\r\n})\r\nexport class SearchModule {}\r\n"],"sourceRoot":"webpack:///"}